# Server Configuration
# PORT is used locally, CHE_PORT is set by Che Operator in production
PORT=8080
CHE_PORT=8080
NODE_ENV=development

# Bind Address (optional)
# By default, the server binds to 0.0.0.0 (all interfaces)
# In Kubernetes/OpenShift, always use 0.0.0.0 to listen on all interfaces
# Note: CHE_HOST is the EXTERNAL hostname (e.g., eclipse-che.apps.xxx.com), NOT the bind address
# CHE_BIND_ADDRESS=0.0.0.0

# API Endpoint (used for OAuth authentication URLs)
# Default: http://localhost:8080
CHE_API_ENDPOINT=http://localhost:8080

# Namespace Configuration
# Template for generating namespace names. Available placeholders:
# <username> - User's username (lowercase)
# <userid> - User's ID (lowercase)
# <workspaceid> - Workspace ID if available (lowercase)
NAMESPACE_TEMPLATE=che-<username>

# Kubernetes Configuration
# The application will attempt to load kubeconfig from default locations:
# 1. KUBECONFIG environment variable
# 2. ~/.kube/config
# 3. In-cluster config (when running in a pod)

# Kubernetes Client Configuration
# ================================

# Local Development Mode
# Set LOCAL_RUN=true to use local kubeconfig instead of in-cluster config
# This is useful when running the server locally and connecting to a remote cluster
LOCAL_RUN=true

# Service Account Token
# For cluster-level operations like listing namespaces.
# In production, this is automatically mounted at /run/secrets/kubernetes.io/serviceaccount/token
# For local development:
#   export SERVICE_ACCOUNT_TOKEN=$(oc whoami -t)
#   or
#   export SERVICE_ACCOUNT_TOKEN=$(kubectl create token che-sa -n che)
SERVICE_ACCOUNT_TOKEN=

# NOTE: The server uses tokens from incoming request headers (request.subject.token)
# Each request is authenticated with the user's own token, enabling proper RBAC and multi-tenancy.
# 
# Authentication Flow:
#   1. Request arrives with Authorization: Bearer <token>
#   2. Auth middleware extracts token -> request.subject.token
#   3. KubeConfigProvider creates KubeConfig with user's token
#   4. Kubernetes API calls use user's permissions (RBAC enforced)

# Factory Configuration
# Comma-separated list of devfile filenames to look for in repositories
# Default: devfile.yaml,.devfile.yaml
CHE_FACTORY_DEFAULT_DEVFILE_FILENAMES=devfile.yaml,.devfile.yaml

# Force refresh of personal access tokens on each factory resolution
# Default: false
CHE_FORCE_REFRESH_PERSONAL_ACCESS_TOKEN=false

